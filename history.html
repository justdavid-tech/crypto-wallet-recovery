<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Recovery History</title>
  <!-- point to the same styles.css (the neon hacker file above) -->
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="history-wrap">
    <header style="display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:18px;">
      <div style="display:flex;align-items:center;gap:12px;">
        <div class="badge">[PORTAL]</div>
        <h1 style="margin:0;font-size:22px;color:var(--accent);text-shadow:0 0 6px var(--accent)">Account Recovery History</h1>
      </div>
      <a href="index.html" class="back-btn">← Back</a>
    </header>

    <div class="history-card card">
      <table aria-label="Recovery history table">
        <thead>
          <tr>
            <th>Date & Time</th>
            <th>Method</th>
            <th>Status</th>
            <th>Location</th>
            <th>Gmail</th>
            <th>Amount</th>
          </tr>
        </thead>
        <tbody id="history-table">
          <!-- rows injected by JS -->
        </tbody>
      </table>
    </div>

    <p class="history-note">Make sure <code>info.json</code> (your transactions file) sits in the same folder as this page.</p>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const tableBody = document.getElementById('history-table');

      fetch('info.json')
        .then(res => {
          if (!res.ok) throw new Error('Failed to load info.json');
          return res.json();
        })
        .then(data => {
          // optional: sort by date string if you want (here we keep original order)
          data.forEach(item => {
            const tr = document.createElement('tr');

            const status = (item.status || '').toLowerCase();
            let statusClass = 'status-pending';
            if (status === 'successful' || status === 'success') statusClass = 'status-success';
            else if (status === 'failed' || status === 'error') statusClass = 'status-failed';
            else if (status === 'pending' || status === 'processing') statusClass = 'status-pending';

            // amount: display as-is (dataset already has $)
            const amountDisplay = item.amount ?? '—';

            tr.innerHTML = `
              <td>${item.dateTime ?? '—'}</td>
              <td>${item.method ?? '—'}</td>
              <td><span class="${statusClass}">${item.status ?? '—'}</span></td>
              <td>${item.location ?? '—'}</td>
              <td>${item.gmail ?? '—'}</td>
              <td style="font-weight:700">${amountDisplay}</td>
            `;
            tableBody.appendChild(tr);
          });

          if (!data || data.length === 0) {
            const tr = document.createElement('tr');
            tr.innerHTML = '<td colspan="6" style="padding:18px;color:var(--muted)">No history found in info.json</td>';
            tableBody.appendChild(tr);
          }
        })
        .catch(err => {
          console.error('Error loading JSON:', err);
          tableBody.innerHTML = `<tr><td colspan="6" style="padding:18px;color:var(--muted)">Error loading history. Check console and ensure <code>info.json</code> exists and is valid JSON.</td></tr>`;
        });
    });
  </script>
</body>
</html>
